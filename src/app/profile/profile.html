<div class="profile-page">
  <div class="wallet-section">
    <div class="profile-picture-wrapper">
      <img
        [src]="user.profile_image"
        alt="User Profile"
        class="profile-picture"
      />
    </div>

    <button class="edit-btn" (click)="openEditModal()">แก้ไขข้อมูล</button>

    <div class="wallet-balance">
      <p>ยอดเงินใน Wallet</p>
      <span>{{ user.walletBalance | number: '1.2-2' }}฿</span>
    </div>

    <div class="topup-section">
      <h3 class="topup-title">เติมเงิน</h3>

      <!-- ปุ่มลัดเติมเงิน -->
<div class="topup-buttons">
  <button (click)="confirmTopUp(100)">100฿</button>
  <button (click)="confirmTopUp(200)">200฿</button>
  <button (click)="confirmTopUp(500)">500฿</button>
</div>

      <!-- กรอกจำนวนเอง -->
      <div class="custom-topup">
        <input
          type="number"
          placeholder="หรือกรอกจำนวนเงิน..."
          [(ngModel)]="customAmount"
        />
        <button (click)="topUp(customAmount)">ยืนยันการเติมเงิน</button>
      </div>
    </div>
  </div>

  <div class="transaction-section">
    <h2>ประวัติการทำรายการ</h2>
    <table>
      <thead>
        <tr>
          <th>วันที่</th>
          <th>รายการ</th>
          <th>จำนวนเงิน</th>
        </tr>
      </thead>
      <tbody>
<tr *ngFor="let tx of transactions">
  <td>{{ tx.date }}</td>
  <td [ngClass]="{ positive: tx.itemType === 'topup', negative: tx.itemType === 'purchase' }">
    {{ tx.item }}
  </td>
  
  <td [ngClass]="{ positive: tx.itemType === 'topup', negative: tx.itemType === 'purchase' }">
    {{ tx.amount | number: '1.2-2' }}฿
  </td>
</tr>
      </tbody>
    </table>
  </div>
</div>

<div class="modal-overlay" *ngIf="isEditModalOpen">
  <div class="modal-content">
    <h3>แก้ไขข้อมูลโปรไฟล์</h3>
    <form (ngSubmit)="saveChanges()">
      <label>ชื่อ</label>
      <input type="text" [(ngModel)]="editableUser.name" name="name" />
      <label>อีเมล</label>
      <input type="email" [(ngModel)]="editableUser.email" name="email" />
      <label>อัปโหลดรูปใหม่</label>
      <input type="file" (change)="onFileSelected($event)" accept="image/*" />
      <img
        *ngIf="previewImageUrl"
        [src]="previewImageUrl"
        class="image-preview"
        alt="Preview"
      />
      <div class="modal-actions">
        <button type="submit" class="save-btn">บันทึก</button>
        <button type="button" class="cancel-btn" (click)="closeEditModal()">
          ยกเลิก
        </button>
      </div>
    </form>
  </div>
</div>
